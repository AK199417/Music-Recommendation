<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="../public/js/authGuard.js"></script>
  <title>Juke Box</title>
  <link href="../public/css/home.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>

<body>
  <nav class="black">
    <div class="nav-wrapper container">
      <a href="#" class="brand-logo left">
        <img src="../public/images/logofinal.png" alt="JukeBox Logo" style="height: 60px;">
      </a>
      <a href="#" data-target="mobile-menu" class="sidenav-trigger right">
        <i class="material-icons white-text">menu</i>
      </a>

      <ul id="nav-mobile" class="right hide-on-large-and-down nav-big">
        <li><a href="./home">HOME</a></li>
        <li><a href="./songrecommendation">SONG RECOMMENDATION</a></li>
        <li><a href="./playlist">PLAYLIST</a></li>
        <li><a href="./about">ABOUT</a></li>
        <li><a href="./" onclick="sessionStorage.clear()">LOG-OUT</a></li>
        <li id="adminTab" style="display: none;"><a href="./admin">Admin</a></li>
        <li>
          <a href="./profile" class="user left">
            <img src="../public/images/user.jpeg" alt="User" style="height: 50px; border-radius: 50%;">
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <ul class="sidenav" id="mobile-menu">
    <li><a href="#">HOME</a></li>
    <li><a href="./songrecommendation">SONG RECOMMENDATION</a></li>
    <li><a href="./playlist">PLAYLIST</a></li>
    <li><a href="./about">ABOUT</a></li>
    <li><a href="./" onclick="sessionStorage.clear()">LOG-OUT</a></li>
    <li id="adminTab" style="display: none;"><a href="./admin">Admin</a></li>
    <li>
      <a href="./profile">
        <img src="../public/images/user.jpeg" alt="User" style="height: 40px; border-radius: 50%;">
      </a>
    </li>
  </ul>

  <main>
    <div class="section">
      <div class="container">
        <div class="row">
          <div class="col s12 center-align">
            <div class="inline-flex-wrapper">
              <p class="white-text flow-text inline-text">
                Want to Discover New Favorites Based on Your Taste?
              </p>
              <a href="./songrecommendation.html" class="btn pink white-text inline-btn">
                CLICK HERE
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>



    <section class="recommended-section">
      <div class="container">
        <h5 class="section-title white-text">Trending Songs</h5>
        <div id="carousel-trending" class="carousel-trending"></div>

        <h5 class="section-title white-text" style="margin-top: 2rem;">Popular Artists</h5>
        <div id="carousel-artists" class="carousel-artists"></div>
      </div>
    </section>

    <div class="chat-icon">
      <a href="#" class="chat-btn btn-floating btn-large pink darken-1">
        <img src="../public/images/chat.png" alt="Chat" style="height: 50px;">
      </a>
    </div>
  </main>
  <footer class="page-footer black">
    <div class="container">
      <div class="row">
        <div class="col l6 s12">
          <p class="grey-text text-lighten-4">Â© 2025 Juke-Box</p>
        </div>
        <div class="col l6 s12 right-align icons">
          <a href="#" class="btn black"><img src="../public/images/Facebook.png" height="30px" alt="Facebook"></a>
          <a href="#" class="btn black"><img src="../public/images/Twitter.png" height="30px" alt="Twitter"></a>
          <a href="#" class="btn black"><img src="../public/images/Instagram.png" height="30px" alt="Instagram"></a>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script src="../public/js/home.js"></script>
  <script src="../public/js/sidenave.js"></script>
  <script>
    $(document).ready(function () {
      // Function to fetch data and render the trending songs carousel
      function fetchTrendingSongs() {
        $.ajax({
          url: 'http://localhost:3000/api/songs/', // Replace with your actual API endpoint
          method: 'GET',
          dataType: 'json',
          success: function (data) {
            if (data && Array.isArray(data) && data.length > 0) {
              let carouselHtml = '';
              data.forEach(song => {
                // Access properties based on your provided JSON structure
                const imageUrl = song.album && song.album.images && song.album.images.length > 0 ? song.album.images[0].url : 'https://via.placeholder.com/150';
                const artistNames = song.artists.map(artist => artist.name).join(', ');

                carouselHtml += `
                        <div >
                            <img src="${imageUrl}" alt="${song.name}" style="width: 100px; height: auto;">
                            <div class="carousel-fixed-item center">
                                <a class="white-text">${song.name} - ${artistNames}</a>
                            </div>
                        </div>
                    `;
              });
              $('#carousel-trending').html(carouselHtml).carousel({
                indicators: true,
                numVisible: 5, // Adjust as needed
                shift: 100,
                padding: 20
              });
            } else {
              $('#carousel-trending').html('<p class="white-text center">No trending songs available.</p>');
            }
          },
          error: function (error) {
            console.error('Error fetching trending songs:', error);
            $('#carousel-trending').html('<p class="white-text center">Failed to load trending songs.</p>');
          }
        });
      }

      function fetchPopularArtists() {
        $.ajax({
          url: '', // Replace with your actual API endpoint
          method: 'GET',
          dataType: 'json',
          success: function (data) {
            if (data && Array.isArray(data) && data.length > 0) {
              let carouselHtml = '';
              data.forEach(artist => {
                const imageUrl = artist.images && artist.images.length > 0 ? artist.images[0].url : 'https://via.placeholder.com/150/CCCCCC/000000?Text=Artist';
                carouselHtml += `
                        <div>
                            <img src="${imageUrl}" alt="${artist.name}" class="popular-artist-image" style="width: 100px; height: auto;">
                            <div class="carousel-fixed-item center">
                                <a class="white-text">${artist.name}</a>
                            </div>
                        </div>
                    `;
              });
              $('#carousel-artists').html(carouselHtml).carousel({
                indicators: true,
                numVisible: 5, // Adjust as needed
                shift: 100,
                padding: 20
              });
            } else {
              $('#carousel-artists').html('<p class="white-text center">No popular artists available.</p>');
            }
          },
          error: function (error) {
            // console.error('Error fetching popular artists:', error);
            console.error('Coming Soon');
            $('#carousel-artists').html('<p class="white-text center">Coming Soon</p>');
          }
        });
      }

      // Call the functions to fetch and render data when the page loads
      fetchTrendingSongs();
      fetchPopularArtists();

      // Initialize Materialize sidenav
      $('.sidenav').sidenav();
    });
  </script>
</body>

</html>